*************************************************
* NOME.....: !CAIXA.PRG                         *
* FUNCAO...: CAIXA()                            *
* AUTOR....: MARCELO LEAL LIMAVERDE CABRAL      *
* SINTAXE..: CAIXA(l,c,l1,c1,[,<expr log>])     *
* DESCRI€AO: Desenha uma caixa na tela          *
*************************************************

FUNC CAIXA

PARAMETERS L1,C1,L2,C2,VL
PRIVATE T,V,CURS

T=.01

IF TYPE("VL")#"L"
 VL=.T.
ENDIF

CURS=SETCURSOR()
SETCURSOR(0)

*LINHA SUPERIOR
FOR V = C1+1 TO C2-1
 @ L1,V SAY CHR(196)
IF VL
 ESTRELA(ROW(),COL())
ENDIF
 INKEY(T)
NEXT

*CANTO SUPERIOR DIREITO
@ L1,C2 SAY CHR(191)
IF VL
ESTRELA(L1+1,C2)
ENDIF
INKEY(T)

*LINHA LATERAL DIREITA
FOR V = L1+1 TO L2-1
 @ V,C2 SAY CHR(179)
IF VL
 ESTRELA(V+1,C2)
ENDIF
 INKEY(T)
NEXT

*CANTO INFERIOR DIREITO
@ L2,C2 SAY CHR(217)
IF VL
ESTRELA(L2,C2-1)
ENDIF
INKEY(T)

*LINHA INFERIOR
V=C2-1
DO WHILE V>=C1+1
 @ L2,V SAY CHR(196)
IF VL
 ESTRELA(ROW(),COL()-2)
ENDIF
 INKEY(T)
 V=V-1
ENDDO

*CANTO INFERIOR ESQUERDO
@ L2,C1 SAY CHR(192)
IF VL
ESTRELA(L2-1,C1)
ENDIF
INKEY(T)

*LINHA LATERAL ESQUERDA
V = L2-1 
DO WHILE V>=L1+1 
 @ V,C1 SAY CHR(179)
 IF VL
 ESTRELA(V-1,C1)
 ENDIF
 INKEY(T)
 V=V-1
ENDDO

*CANTO SUPERIOR ESQUERDO
@ L1,C1 SAY CHR(218)

SETCURSOR(CURS)

RETURN(.T.)

FUNCTION ESTRELA
PARAMETERS L3,C3
PRIVATE OLDCOR
OLDCOR=SETCOLOR()
SET COLOR TO W+
@ L3,C3 SAY '*'
SETCOLOR(OLDCOR)
RETURN(.T.)
*******************************
